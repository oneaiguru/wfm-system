(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc550904"],{"0798":function(t,e,a){"use strict";a("0c18");var s=a("10d2"),r=a("afdd"),o=a("9d26"),i=a("f2e7"),n=a("7560"),l=a("f40d"),c=a("58df"),d=a("d9bd");e["a"]=Object(c["a"])(s["a"],i["a"],l["a"]).extend({name:"v-alert",props:{border:{type:String,validator(t){return["top","right","bottom","left"].includes(t)}},closeLabel:{type:String,default:"$vuetify.close"},coloredBorder:Boolean,dense:Boolean,dismissible:Boolean,closeIcon:{type:String,default:"$cancel"},icon:{default:"",type:[Boolean,String],validator(t){return"string"===typeof t||!1===t}},outlined:Boolean,prominent:Boolean,text:Boolean,type:{type:String,validator(t){return["info","error","success","warning"].includes(t)}},value:{type:Boolean,default:!0}},computed:{__cachedBorder(){if(!this.border)return null;let t={staticClass:"v-alert__border",class:{["v-alert__border--"+this.border]:!0}};return this.coloredBorder&&(t=this.setBackgroundColor(this.computedColor,t),t.class["v-alert__border--has-color"]=!0),this.$createElement("div",t)},__cachedDismissible(){if(!this.dismissible)return null;const t=this.iconColor;return this.$createElement(r["a"],{staticClass:"v-alert__dismissible",props:{color:t,icon:!0,small:!0},attrs:{"aria-label":this.$vuetify.lang.t(this.closeLabel)},on:{click:()=>this.isActive=!1}},[this.$createElement(o["a"],{props:{color:t}},this.closeIcon)])},__cachedIcon(){return this.computedIcon?this.$createElement(o["a"],{staticClass:"v-alert__icon",props:{color:this.iconColor}},this.computedIcon):null},classes(){const t={...s["a"].options.computed.classes.call(this),"v-alert--border":Boolean(this.border),"v-alert--dense":this.dense,"v-alert--outlined":this.outlined,"v-alert--prominent":this.prominent,"v-alert--text":this.text};return this.border&&(t["v-alert--border-"+this.border]=!0),t},computedColor(){return this.color||this.type},computedIcon(){return!1!==this.icon&&("string"===typeof this.icon&&this.icon?this.icon:!!["error","info","success","warning"].includes(this.type)&&"$"+this.type)},hasColoredIcon(){return this.hasText||Boolean(this.border)&&this.coloredBorder},hasText(){return this.text||this.outlined},iconColor(){return this.hasColoredIcon?this.computedColor:void 0},isDark(){return!(!this.type||this.coloredBorder||this.outlined)||n["a"].options.computed.isDark.call(this)}},created(){this.$attrs.hasOwnProperty("outline")&&Object(d["a"])("outline","outlined",this)},methods:{genWrapper(){const t=[this.$slots.prepend||this.__cachedIcon,this.genContent(),this.__cachedBorder,this.$slots.append,this.$scopedSlots.close?this.$scopedSlots.close({toggle:this.toggle}):this.__cachedDismissible],e={staticClass:"v-alert__wrapper"};return this.$createElement("div",e,t)},genContent(){return this.$createElement("div",{staticClass:"v-alert__content"},this.$slots.default)},genAlert(){let t={staticClass:"v-alert",attrs:{role:"alert"},on:this.listeners$,class:this.classes,style:this.styles,directives:[{name:"show",value:this.isActive}]};if(!this.coloredBorder){const e=this.hasText?this.setTextColor:this.setBackgroundColor;t=e(this.computedColor,t)}return this.$createElement("div",t,[this.genWrapper()])},toggle(){this.isActive=!this.isActive}},render(t){const e=this.genAlert();return this.transition?t("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[e]):e}})},"0c18":function(t,e,a){},1717:function(t,e,a){"use strict";a("5f88")},"2a7f":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var s=a("71d9"),r=a("80d2");const o=Object(r["j"])("v-toolbar__title"),i=Object(r["j"])("v-toolbar__items");s["a"]},"3c91":function(t,e,a){"use strict";a.r(e);var s=a("0798"),r=a("8336"),o=a("b0af"),i=a("a523"),n=a("2e4b"),l=(a("20f6"),a("e8f2")),c=Object(l["a"])("flex"),d=a("132d"),u=a("e449"),h=a("2fa4"),f=a("71a3"),p=a("fe57"),_=a("9a96"),m=a("8654"),v=a("71d9"),b=a("2a7f"),g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex flex-column flex-grow-1"},[e("div",{staticClass:"d-flex align-center py-3"},[e("div",[e("div",{staticClass:"display-1"},[t._v(t._s(t.$t("menu.workRules")))])])]),e(o["a"],{staticClass:"d-flex flex-column flex-grow-1",attrs:{outlined:""}},[t.emptyResp?e(s["a"],{staticClass:"ma-2",attrs:{color:"warning",rounded:!0}},[e("div",{staticClass:"pa-1",staticStyle:{"white-space":"normal"}},[t._v(" "+t._s(t.$t("desires.noPeriod"))+" ")])]):t._e(),e("div",{staticClass:"pa-2"},[e("div",{staticClass:"d-flex justify-start align-center flex-wrap"},[e("div",{staticClass:"d-flex flex-wrap d-flex pa-3"},[e(u["a"],{ref:"menu",attrs:{"return-value":t.menuDate,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(e){t.menuDate=e},"update:return-value":function(e){t.menuDate=e}},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(m["a"],t._g(t._b({attrs:{value:t.formatDateReverseStart,readonly:""}},"v-text-field",s,!1),a))]}}]),model:{value:t.menuStart,callback:function(e){t.menuStart=e},expression:"menuStart"}},[e(n["a"],{attrs:{"no-title":"",scrollable:"","first-day-of-week":"1"},model:{value:t.dateStart,callback:function(e){t.dateStart=e},expression:"dateStart"}})],1)],1),e("div",{staticClass:"d-flex flex-wrap pa-3"},[e(u["a"],{ref:"menu",attrs:{"return-value":t.menuDate,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(e){t.menuDate=e},"update:return-value":function(e){t.menuDate=e}},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:s}){return[e(m["a"],t._g(t._b({attrs:{value:t.formatDateReverseEnd,readonly:"",disabled:null==t.dateStart}},"v-text-field",s,!1),a))]}}]),model:{value:t.menuEnd,callback:function(e){t.menuEnd=e},expression:"menuEnd"}},[null!==this.dateStart?e(n["a"],{attrs:{"no-title":"",scrollable:"","allowed-dates":t.checkStartDates,"first-day-of-week":"1"},model:{value:t.dateEnd,callback:function(e){t.dateEnd=e},expression:"dateEnd"}}):t._e()],1)],1),e("div",{staticClass:"d-flex flex-wrap pa-3"},[e(r["a"],{attrs:{color:"primary"},on:{click:t.applyDates}},[t._v(" "+t._s(t.$t("desires.show"))+" ")])],1)])]),t.workRules?e(i["a"],{attrs:{"grid-list-md":"","text-xs-center":"",fluid:""}},[e(c,t._l(t.workRules,(function(a){return e(o["a"],{key:""+a.id,staticClass:"d-flex flex-column flex-grow-3 mb-3 rotation-table"},[e(v["a"],{scopedSlots:t._u([{key:"extension",fn:function(){return[e(p["a"],{staticClass:"marginLeft",attrs:{"align-with-title":""}},[e(_["a"],{attrs:{color:"primary"}}),e(f["a"],{on:{click:function(e){return t.selectTab(a.id,t.TAB_WORK_RULES)}}},[t._v(t._s(t.$t("desires.workdays"))+" ")]),a.withRotation?e(f["a"],{on:{click:function(e){return t.selectTab(a.id,t.TAB_ROTATIONS)}}},[t._v(t._s(t.$t("desires.rotations"))+" ")]):t._e()],1)]},proxy:!0}],null,!0)},[e(b["a"],[e("div",{staticClass:"d-flex justify-start align-center flex-wrap toolbar"},[e("div",{staticClass:"font-weight-bold d-flex flex-wrap d-flex pa-3"},[t._v(t._s(a.name))]),t._v(" - "),e("div",{staticClass:"d-flex flex-wrap d-flex pa-3"},[t._v("("+t._s(t.formatDateToDMY(a.dateStart))+" - "+t._s(t.formatDateToDMY(a.dateEnd))+")")])])]),e(h["a"])],1),t.activeTabs[a.id]===t.TAB_WORK_RULES?e(o["a"],[e("table",[e("thead",[e("tr",[e("th",[t._v(" "+t._s(t.$t("desires.workday"))+" ")]),e("th",[t._v(" "+t._s(t.$t("desires.begin"))+" ")]),e("th",[t._v(" "+t._s(t.$t("desires.duration"))+" ")])])]),e("tbody",t._l(a.workDays,(function(a,s){return e("tr",[e("td",[t._v(t._s(t.$t("desires.shift")+"â„–"+(s+1)))]),e("td",[t._v(t._s(t.formatUtc(a.firstStart))+" - "+t._s(t.formatUtc(a.secondStart)))]),e("td",[t._v(t._s(t.formatUtc(a.minDuration))+" - "+t._s(t.formatUtc(a.maxDuration)))])])})),0)])]):t._e(),t.activeTabs[a.id]===t.TAB_ROTATIONS&&a.withRotation?e(o["a"],{attrs:{flat:""}},[e("table",[e("thead",[e("tr",[e("th",[t._v(" "+t._s(t.$t("desires.rotations"))+" ")]),t._l(a.rotations[0].workShift,(function(a,s){return e("th",[t._v(" "+t._s(s+1)+" ")])})),e("th",[t._v(" "+t._s(t.$t("desires.selected"))+" ")]),e("th",[t._v(" "+t._s(t.$t("desires.anchored"))+" ")])],2)]),e("tbody",t._l(a.rotations,(function(s,o){return e("tr",[e("td",{staticClass:"text"},[t._v(t._s(t.$t("desires.rotation")+" "+(o+1)))]),t._l(s.workShift,(function(a){return e("td",[t._v(" "+t._s(a||t.$t("desires.weekend"))+" ")])})),t._l(t.ROTATION_TYPES,(function(o){return e("td",{staticClass:"text"},[e(r["a"],{attrs:{icon:"",color:t.rotationColor(s[o])},on:{click:function(e){o===t.ROTATION_TYPE_ANCHORED||t.toggleRotation(a.id,s.name,o)}}},[e(d["a"],[t._v("check_circle")])],1)],1)}))],2)})),0)]),e("div",{staticClass:"d-flex justify-start align-center flex-wrap"},[e("div",{staticClass:"d-flex flex-wrap pa-3"},[e(r["a"],{staticClass:"pa-3",attrs:{color:"primary"},on:{click:function(e){return t.saveRotations()}}},[t._v(" "+t._s(t.$t("desires.apply"))+" ")])],1)])]):t._e()],1)})),1)],1):t._e()],1)],1)},w=[],y=a("4786"),x=a("be3b");class D{getWorkRules(t,e){const a={startDate:t,endDate:e};return x["a"].get("api/v1/workRules",{params:a})}changeRotation(t){return x["a"].post("api/v1/workRules/changeRotation",t,{headers:Object(y["a"])()})}}var T=new D,S=a("ec45"),k=(a("411c"),a("107a"),a("124d")),R=a("c1df"),C=a.n(R),$=a("2f62");const E="TAB_WORK_RULES",O="TAB_ROTATIONS",A="isSelected",B="isAnchored",I=[A,B];var j={name:"DesirePage",components:{DatePicker:S["default"]},data(){return{ROTATION_TYPES:I,ROTATION_TYPE_ANCHORED:B,TAB_ROTATIONS:O,TAB_WORK_RULES:E,workRules:null,mayAnchored:!1,dateStart:null,dateEnd:null,start:0,end:0,menuStart:!1,menuEnd:!1,menuDate:null,activeTabs:{},emptyResp:!1}},computed:{formatDateReverseStart(){return this.dateStart?k["a"].formatDateToDMY(this.dateStart):this.$t("DateFrom")},formatDateReverseEnd(){return this.dateEnd?k["a"].formatDateToDMY(this.dateEnd):this.$t("DateTo")}},created(){let t=C()().startOf("week").toDate(),e=C()().endOf("week").toDate();t.setDate(t.getDate()+1),e.setDate(e.getDate()+1),this.dateStart=this.mapToLocalDate(t),this.dateEnd=this.mapToLocalDate(e),this.applyDates()},methods:{...Object($["b"])("app",["showToast","showError","showSuccess"]),mapToLocalDate(t){let e=String(t.getDate()+1).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();return`${s}-${a}-${e}`},formatUtc:k["a"].formatUtcDateToLocaleTime,formatDateToDMY:k["a"].formatDateToDMY,applyDates(){this.emptyResp=!1,T.getWorkRules(this.dateStart,this.dateEnd).then(({data:t})=>{const{workRules:e,mayAnchored:a}=t;this.activeTabs=Object.fromEntries(e.map(({id:t})=>[t,E])),this.workRules=e,this.mayAnchored=a,this.emptyResp=!this.workRules.length}).catch(t=>console.error("error",t))},rotationColor(t){return t?"blue":"gray"},selectTab(t,e){this.activeTabs={...this.activeTabs,[t]:e}},toggleRotation(t,e,a){this.workRules=this.workRules.map(s=>{if(s.id===t){const t=s.rotations.map(t=>{const{name:s}=t;return s===e?{...t,[a]:!t[a]}:t});return{...s,rotations:t}}return s})},saveRotations(){T.changeRotation({workRules:this.workRules,mayAnchored:this.mayAnchored}).then(t=>{this.showSuccess({description:this.$t("desires.workRulesWasConfirmed")})})},checkStartDates(t){return t>this.dateStart}}},L=j,Y=(a("1717"),a("2877")),N=Object(Y["a"])(L,g,w,!1,null,"597c1754",null);e["default"]=N.exports},"5f88":function(t,e,a){}}]);